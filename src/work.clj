(ns work)
(use 'greenwood.math)
(use 'greenwood.xyz 'greenwood.atomic-structure-output 'greenwood.contrib-math)
(use 'greenwood.mol :reload)
(use 'greenwood.supercell :reload)
(use 'greenwood.empirical-data)
(use 'graphitic :reload)
(use 'greenwood.neighbors :reload)
(use '[clojure.string :only [join]])
(use 'reaxff)


(def graphene (xyz-str->atoms "C   0.0   0.0   0.17157525
C   2.4830706E-9   1.4655745   -0.19588877
C   -1.2138458   2.1663888   -0.19588877
C   -1.2138458   3.5680172   -0.19588877
C   2.4830706   -0.031973004   -0.19588877
C   2.4830706   1.4336015   0.17157525
C   1.2138458   2.1663888   -0.19588877
C   1.2138458   3.5680172   -0.19588877
F   0.0   0.0   1.7182837
F   2.4830706   1.4336015   1.7182837
C   -2.4830706   4.300804   0.17157525
C   -2.4830706   5.766379   -0.19588877
C   -3.6969163   6.467193   -0.19588877
C   -3.6969163   7.8688216   -0.19588877
C   0.0   4.2688313   -0.19588877
C   2.4830706E-9   5.734406   0.17157525
C   -1.2692248   6.467193   -0.19588877
C   -1.2692248   7.8688216   -0.19588877
F   -2.4830706   4.300804   1.7182837
F   2.4830706E-9   5.734406   1.7182837
C   -4.966141   8.601608   0.17157525
C   -4.966141   10.0671835   -0.19588877
C   -6.179987   10.767998   -0.19588877
C   -6.179987   12.169626   -0.19588877
C   -2.4830706   8.569635   -0.19588877
C   -2.4830706   10.035211   0.17157525
C   -3.7522953   10.767998   -0.19588877
C   -3.7522953   12.169626   -0.19588877
F   -4.966141   8.601608   1.7182837
F   -2.4830706   10.035211   1.7182837
C   -7.4492116   12.902413   0.17157525
C   -7.4492116   14.367988   -0.19588877
C   -8.663057   15.068802   -0.19588877
C   -8.663057   16.47043   -0.19588877
C   -4.966141   12.8704405   -0.19588877
C   -4.966141   14.336015   0.17157525
C   -6.235366   15.068802   -0.19588877
C   -6.235366   16.47043   -0.19588877
F   -7.4492116   12.902413   1.7182837
F   -4.966141   14.336015   1.7182837
C   4.966141   0.0   0.17157525
C   4.966141   1.4655745   -0.19588877
C   3.7522953   2.1663888   -0.19588877
C   3.7522953   3.5680172   -0.19588877
C   7.4492116   -0.031973004   -0.19588877
C   7.4492116   1.4336015   0.17157525
C   6.179987   2.1663888   -0.19588877
C   6.179987   3.5680172   -0.19588877
F   4.966141   0.0   1.7182837
F   7.4492116   1.4336015   1.7182837
C   2.4830706   4.300804   0.17157525
C   2.4830706   5.766379   -0.19588877
C   1.2692248   6.467193   -0.19588877
C   1.2692248   7.8688216   -0.19588877
C   4.966141   4.2688313   -0.19588877
C   4.966141   5.734406   0.17157525
C   3.6969163   6.467193   -0.19588877
C   3.6969163   7.8688216   -0.19588877
F   2.4830706   4.300804   1.7182837
F   4.966141   5.734406   1.7182837
C   0.0   8.601608   0.17157525
C   2.4830706E-9   10.0671835   -0.19588877
C   -1.2138458   10.767998   -0.19588877
C   -1.2138458   12.169626   -0.19588877
C   2.4830706   8.569635   -0.19588877
C   2.4830706   10.035211   0.17157525
C   1.2138458   10.767998   -0.19588877
C   1.2138458   12.169626   -0.19588877
F   0.0   8.601608   1.7182837
F   2.4830706   10.035211   1.7182837
C   -2.4830706   12.902413   0.17157525
C   -2.4830706   14.367988   -0.19588877
C   -3.6969163   15.068802   -0.19588877
C   -3.6969163   16.47043   -0.19588877
C   0.0   12.8704405   -0.19588877
C   2.4830706E-9   14.336015   0.17157525
C   -1.2692248   15.068802   -0.19588877
C   -1.2692248   16.47043   -0.19588877
F   -2.4830706   12.902413   1.7182837
F   2.4830706E-9   14.336015   1.7182837
C   9.932282   0.0   0.17157525
C   9.932282   1.4655745   -0.19588877
C   8.718436   2.1663888   -0.19588877
C   8.718436   3.5680172   -0.19588877
C   12.415353   -0.031973004   -0.19588877
C   12.415353   1.4336015   0.17157525
C   11.146128   2.1663888   -0.19588877
C   11.146128   3.5680172   -0.19588877
F   9.932282   0.0   1.7182837
F   12.415353   1.4336015   1.7182837
C   7.4492116   4.300804   0.17157525
C   7.4492116   5.766379   -0.19588877
C   6.235366   6.467193   -0.19588877
C   6.235366   7.8688216   -0.19588877
C   9.932282   4.2688313   -0.19588877
C   9.932282   5.734406   0.17157525
C   8.663057   6.467193   -0.19588877
C   8.663057   7.8688216   -0.19588877
F   7.4492116   4.300804   1.7182837
F   9.932282   5.734406   1.7182837
C   4.966141   8.601608   0.17157525
C   4.966141   10.0671835   -0.19588877
C   3.7522953   10.767998   -0.19588877
C   3.7522953   12.169626   -0.19588877
C   7.4492116   8.569635   -0.19588877
C   7.4492116   10.035211   0.17157525
C   6.179987   10.767998   -0.19588877
C   6.179987   12.169626   -0.19588877
F   4.966141   8.601608   1.7182837
F   7.4492116   10.035211   1.7182837
C   2.4830706   12.902413   0.17157525
C   2.4830706   14.367988   -0.19588877
C   1.2692248   15.068802   -0.19588877
C   1.2692248   16.47043   -0.19588877
C   4.966141   12.8704405   -0.19588877
C   4.966141   14.336015   0.17157525
C   3.6969163   15.068802   -0.19588877
C   3.6969163   16.47043   -0.19588877
F   2.4830706   12.902413   1.7182837
F   4.966141   14.336015   1.7182837
C   14.898423   0.0   0.17157525
C   14.898423   1.4655745   -0.19588877
C   13.684578   2.1663888   -0.19588877
C   13.684578   3.5680172   -0.19588877
C   17.381495   -0.031973004   -0.19588877
C   17.381495   1.4336015   0.17157525
C   16.112268   2.1663888   -0.19588877
C   16.112268   3.5680172   -0.19588877
F   14.898423   0.0   1.7182837
F   17.381495   1.4336015   1.7182837
C   12.415353   4.300804   0.17157525
C   12.415353   5.766379   -0.19588877
C   11.201507   6.467193   -0.19588877
C   11.201507   7.8688216   -0.19588877
C   14.898423   4.2688313   -0.19588877
C   14.898423   5.734406   0.17157525
C   13.629199   6.467193   -0.19588877
C   13.629199   7.8688216   -0.19588877
F   12.415353   4.300804   1.7182837
F   14.898423   5.734406   1.7182837
C   9.932282   8.601608   0.17157525
C   9.932282   10.0671835   -0.19588877
C   8.718436   10.767998   -0.19588877
C   8.718436   12.169626   -0.19588877
C   12.415353   8.569635   -0.19588877
C   12.415353   10.035211   0.17157525
C   11.146128   10.767998   -0.19588877
C   11.146128   12.169626   -0.19588877
F   9.932282   8.601608   1.7182837
F   12.415353   10.035211   1.7182837
C   7.4492116   12.902413   0.17157525
C   7.4492116   14.367988   -0.19588877
C   6.235366   15.068802   -0.19588877
C   6.235366   16.47043   -0.19588877
C   9.932282   12.8704405   -0.19588877
C   9.932282   14.336015   0.17157525
C   8.663057   15.068802   -0.19588877
C   8.663057   16.47043   -0.19588877
F   7.4492116   12.902413   1.7182837
F   9.932282   14.336015   1.7182837"))



(def graphene_DMMP_removed (xyz-str->atoms "C       -0.009246223   0.013871026   0.142529221
C       -0.009397977   1.477144735  -0.216433866
C       -1.223221943   2.177783928  -0.219616567
C       -1.223712780   3.578847724  -0.239749439
C        2.474401270  -0.019892376  -0.199347173
C        2.474189581   1.450680740   0.125659295
C        1.204162104   2.177433616  -0.232558499
C        1.203843867   3.578668628  -0.259830741
F       -0.010136784   0.020353588   1.605373557
F        2.474304828   1.475501458   1.589395501
C       -2.487977008   4.316058850   0.118331068
C       -2.494625472   5.779318967  -0.239632468
C       -3.707722696   6.480204134  -0.218952302
C       -3.707520240   7.881734706  -0.219603394
C       -0.010161026   4.279221916  -0.264532333
C       -0.008257262   5.748603841   0.065157490
C       -1.281437503   6.480090272  -0.268184536
C       -1.280972088   7.881693611  -0.268053143
F       -2.463140375   4.328314402   1.582427982
F       -0.002489620   5.756215730   1.531719103
C       -4.973547122   8.613445460   0.143271133
C       -4.975791691  10.080569766  -0.197613361
C       -6.189247317  10.781088672  -0.190278784
C       -6.188967175  12.182310112  -0.186167453
C       -2.494309089   8.582516068  -0.240848461
C       -2.487683727  10.046819141   0.114967699
C       -3.762606721  10.781495838  -0.207214864
C       -3.762440098  12.182620027  -0.199922290
F       -4.964257537   8.606911564   1.606125323
F       -2.465745220  10.036941342   1.577316624
C       -7.459177952  12.914156046   0.160161947
C       -7.457670873  14.380834769  -0.184671898
C       -8.671319601  15.081380087  -0.191980388
C       -8.671277650  16.482567868  -0.197575149
C       -4.975680527  12.883143023  -0.187994048
C       -4.974560373  14.348477232   0.161993025
C       -6.244334505  15.081533852  -0.183417765
C       -6.244342302  16.482668587  -0.190874373
F       -7.463979457  12.908794877   1.622409635
F       -4.971252715  14.346363836   1.624637307
C        4.956646822   0.015947743   0.150653899
C        4.957736806   1.477329846  -0.215610036
C        3.743976055   2.177444079  -0.233477696
C        3.743774577   3.578485154  -0.264139463
C        7.439328444  -0.019500723  -0.195562050
C        7.438935432   1.448227044   0.142332630
C        6.171452517   2.177918850  -0.219229058
C        6.171788432   3.579006179  -0.245566676
F        4.953585908   0.032515260   1.613381125
F        7.432541900   1.458045483   1.605780180
C        2.474308452   4.317063981   0.071546922
C        2.472668557   5.778199400  -0.292898060
C        1.258985241   6.478651696  -0.293214577
C        1.259322660   7.880185765  -0.304108056
C        4.957649843   4.278929301  -0.274484426
C        4.955167283   5.750033826   0.048496484
C        3.686018909   6.478916632  -0.308053457
C        3.686492947   7.880274998  -0.322449943
F        2.476558492   4.333931938   1.537023257
F        4.947390892   5.761094510   1.511019771
C       -0.005439484   8.613282257   0.060337035
C       -0.010780452  10.081705661  -0.276039475
C       -1.224030691  10.782344979  -0.246793890
C       -1.223786917  12.183507827  -0.231970774
C        2.472751652   8.580945858  -0.319279624
C        2.475031347  10.045450042   0.039369873
C        1.202522751  10.782497404  -0.288865103
C        1.202985756  12.183683676  -0.266946689
F        0.012447106   8.604485019   1.524363127
F        2.480452695  10.028043644   1.493104487
C       -2.488741916  12.912903317   0.138005389
C       -2.493012079  14.381461921  -0.198409284
C       -3.706411358  15.081949287  -0.187976463
C       -3.706446345  16.483140538  -0.189743572
C       -0.010253029  12.884165478  -0.239757143
C       -0.006741309  14.346177558   0.123960312
C       -1.279582327  15.082107573  -0.205208236
C       -1.279534041  16.483132238  -0.199454326
F       -2.473041246  12.901456475   1.599906628
F        0.005072809  14.333253377   1.585740670
C        9.922775006   0.011419789   0.148886784
C        9.923551387   1.478533136  -0.193369721
C        8.710136517   2.179057691  -0.202808173
C        8.710164826   3.580372042  -0.214535689
C       12.405902961  -0.017835503  -0.197855225
C       12.406444662   1.445737395   0.157796210
C       11.137172482   2.179325049  -0.189169482
C       11.137214611   3.580618696  -0.193065903
F        9.920982210   0.003767605   1.611541430
F       12.407418823   1.441468344   1.620279023
C        7.436774233   4.318147058   0.105007665
C        7.442175761   5.779013552  -0.261725150
C        6.228450313   6.479201209  -0.294769946
C        6.228806317   7.880845448  -0.307522310
C        9.923840392   4.281047472  -0.207224868
C        9.919004178   5.749091659   0.129629877
C        8.655566263   6.479752766  -0.244011386
C        8.655689884   7.881199822  -0.252485611
F        7.419429941   4.340072742   1.571651626
F        9.897475667   5.756995858   1.593703275
C        4.955559082   8.613935821   0.028704383
C        4.957700459  10.082342963  -0.308657903
C        3.743934597  10.782717303  -0.304589975
C        3.744351503  12.183842426  -0.280794783
C        7.442305117   8.581737957  -0.282723962
C        7.435771079  10.046686172   0.072604321
C        6.170944095  10.782864816  -0.285232555
C        6.171260144  12.183975103  -0.263757630
F        4.952018990   8.606804791   1.483999615
F        7.417453557  10.036520343   1.533500076
C        2.475689740  12.911141481   0.082371550
C        2.473777187  14.383198571  -0.240151553
C        1.260316190  15.083770051  -0.223488381
C        1.260151741  16.484719867  -0.204133241
C        4.957614207  12.884602429  -0.262596699
C        4.956218670  14.344967468   0.107924369
C        3.687250414  15.083920776  -0.229766139
C        3.687161624  16.484815388  -0.208111965
F        2.483041228  12.891532713   1.542222121
F        4.952268631  14.326527958   1.569125154
C       14.889746024   0.011013968   0.143259188
C       14.889044698   1.479103717  -0.194441812
C       13.675499799   2.179864874  -0.188716954
C       13.675357897   3.580916748  -0.188211470
C       17.372760408  -0.018940233  -0.205822361
C       17.374241681   1.446831781   0.140433727
C       16.102668500   2.179471590  -0.199483170
C       16.102579964   3.580635250  -0.204093163
F       14.893146033   0.000360479   1.605730023
F       17.384800011   1.449281762   1.603286886
C       12.405411316   4.314203714   0.157203674
C       12.406508378   5.779002700  -0.192961475
C       11.193095508   6.479647914  -0.204171483
C       11.193154415   7.880991883  -0.210693391
C       14.888886135   4.281242967  -0.196628730
C       14.892041452   5.747776652   0.145850243
C       13.620024392   6.479467502  -0.194366862
C       13.620032591   7.880883783  -0.199154131
F       12.401165366   4.315847628   1.620274133
F       14.907046938   5.749415007   1.608603821
C        9.918874978   8.614644287   0.117123932
C        9.924837631  10.081110009  -0.227529133
C        8.711455762  10.781932517  -0.246927575
C        8.711411111  12.183305121  -0.234195052
C       12.406639264   8.581393153  -0.203544910
C       12.404786340  10.046347690   0.148554506
C       11.138146786  10.781429009  -0.204642041
C       11.138139147  12.182686026  -0.197837456
F        9.897189471   8.614258643   1.580075774
F       12.397041391  10.036835634   1.611067606
C        7.437035657  12.912067320   0.106023868
C        7.440831699  14.382267687  -0.223782441
C        6.227169281  15.082997765  -0.224024558
C        6.226948675  16.483945716  -0.210718038
C        9.924728865  12.883449573  -0.209808169
C        9.921240859  14.347879854   0.144362269
C        8.654283598  15.082480731  -0.209099816
C        8.654149915  16.483544504  -0.204619686
F        7.424061142  12.896403300   1.567395884
F        9.910248689  14.342035467   1.606871414"))








(defn avCCC
  [mol]
  (as-> mol x
       (mol-filter {:species "C"} x)
      (neighbors x 0.1 1.9)
      (angles x)
      (flatten x)
      (filter (complement nil?) x)
      (map :radians x)
        (map radians->degrees x)
      (simple-stats x)))





(avCCC  graphene)
(avCCC graphene_DMMP_removed )



(use 'greenwood.utils)

(def juniorprimary (clean-parse "/Users/chadjunkermeier/Desktop/g.txt"))

(defn mail
    [names]
  (join "\n\n\n\n\n"
  (loop [talk (first names)
         prayer (second names)
         scripture (third names)
         nms (drop 3 names)
         hm []]
    (if (nil? talk)
      hm
   (recur (first nms)
          (second nms)
          (third nms)
          (drop 3 nms)
          (conj hm (str talk " is assigned a talk in primary\n\non ____________________________ \n\non the topic: ____________________________\n\n\n\n"
                        prayer " is assigned a prayer in primary\n\non ____________________________ \n\n\n\n"
              scripture " is assigned a talk in primary\n\non ____________________________ \n\nscripture: __________________\n\n\n\n")))))))




(spit  "/Users/chadjunkermeier/Desktop/ghi.txt" (mail juniorprimary))






(def all (xyz-str->atoms "C        0.000000000   0.000000000   0.009868572
C        0.166666791   0.333333582  -0.009868544
F        0.000000000   0.000000000   0.066205232
F        0.166666285   0.333332570  -0.066205098
C        0.000000302   0.500000151   0.009868551
C        0.166666791   0.833333179  -0.009868544
F        0.000000387   0.500000194   0.066204873
F        0.166666285   0.833333685  -0.066205098
C        0.499999849  -0.000000302   0.009868551
C        0.666666700   0.333333340  -0.009868637
F        0.499999806  -0.000000387   0.066204873
F        0.666666700   0.333333340  -0.066204510
C        0.499999849   0.500000151   0.009868551
C        0.666666458   0.833333179  -0.009868544
F        0.499999806   0.500000194   0.066204873
F        0.666667470   0.833333685  -0.066205098"))
(def all_a 4.924182376003504)


(def allsc (supercell (QE-to-xyz all all_a 2) (QE-to-lvs all_a 2) 4 4 1))
;(count (mol-filter  {:species "C"} (:mol allsc)))


;(count (mol-filter {:species "C"} (first (parse-xyz  "/Users/chadjunkermeier/Desktop/graphene.xyz"))))


;(spit "/Users/chadjunkermeier/Desktop/dmmpgr.xyz" (write-xyz (:mol allsc)))


 (:lvs allsc)

